{
  "hash": "b252ed61fa44f52f01f3b2ae4cc601fb",
  "result": {
    "engine": "knitr",
    "markdown": "\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n# Preface {.unnumbered}\n\nThese are the notes for SM-4331 Advanced Statistics.\n\n# What is statistics?\n\n**Statistics** is a scientific subject on collecting and analysing data.\n\n-   **Collecting** means designing experiments, designing\n    questionnaires, designing sampling schemes, administration of data\n    collection.\n\n-   **Analysing** means modelling, estimation, testing, forecasting.\n\n\n![](figures/00-ds2.png){#fig-statsdatascience}\n\n\nStatistics is an application-oriented mathematical subject; it is\nparticularly useful or helpful in answering questions such as:\n\n-   Does a certain new drug prolong life for AIDS sufferers?\n-   Is global warming really happening?\n-   Are O-level and A-level examinations standard declining?\n-   Is the house market in Brunei oversaturated?\n-   Is the Chinese yuan undervalued? If so, by how much?\n\n\nThere are three aspects to learning statistics:\n\n1. **Ideas and concepts**. Understanding why statistics is needed, and what you are able to do and not do with statistics.\n2. **Methods**. Knowing \"how to do\" (applied) statistics. \n3. **Theory**. Knowing the \"why\" of statistics and understanding why things are the way they are. Very mathematics focused. \n\nIn this course, there is an emphasis on the **theory** aspect of statistics.\n\n> *Students who analyze data, or who aspire to develop new methods for analyzing data, should be well grounded in basic probability and mathematical statistics. Using fancy tools like neural nets, boosting, and support vector machines without understanding basic statistics is like doing brain surgery before knowing how to use a band-aid.*  \n>\n::: {.content-visible unless-format=\"pdf\"}\n> <div style=\"text-align: right;\">---Larry Wasserman (in All of Statistics)</div>\n:::\n::: {.content-visible when-format=\"pdf\"}\n\\hfill ---Larry Wasserman (in All of Statistics)\n:::\n\n\n## A probability example\n\nIn Brunei, boba tea is a sensation, with countless shops vying for the title of the \"best\" through customer satisfaction ratings. \n*Tapioca Treasure*, one of the crowd favorites, boasts an impressive 4.3 out of 5-star rating—based on a simple question: *Do you like their bubble tea?*  \n\n![Credits: Unsplash [\\@Snappr](https://unsplash.com/photos/three-different-colored-cups-sitting-on-top-of-a-wooden-table-QN66qNwc1n8).](https://images.unsplash.com/photo-1734770580735-796a00e42cb2?q=80&w=2070&auto=format&fit=crop&ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D){#fig-bubbletea}\n\nIntrigued, you and a friend decide to visit and sample their offerings. This raises some interesting **probability**-based questions:\n\n::: {#exr-probability}\na. What is the probability that you like the bubble tea?  \nb. What is the probability that at least one of you likes the bubble tea?  \nc. Suppose you invite your entire family of size \\(n\\). What is the expected number of people who will enjoy the bubble tea?  \n:::\n\n*[Of course, these questions involve certain assumptions, which we'll discuss in a bit.]*  \n\n\n::: {#sol-probability}\n\nLet $X$ represent whether a person likes the bubble tea at *Tapioca Treasure*. \nWe may write\n$$\nX = \\begin{cases}\n1 & \\text{likes tea} \\\\\n0 & \\text{does not like tea} \\\\\n\\end{cases}\n$$\nwhich is a convenient way of \"coding\" the qualitative response of like / do not like into numbers (1/0).\nSuppose that $X$ is a random variable, then we may also write\n$$\n\\Pr(X=1) := \\theta = 0.86,\n$$\nbased on the shop's 4.3/5 star rating, interpreted as an 86% likelihood of liking the bubble tea.\nSince $X$ is a binary random variable (i.e. takes only two outcomes), $X$ is said to follow a *Bernoulli* distribution^[Which is a special case of the binomial distribution which you might be more familiar with ($n=1$).].\n\na. Since $X \\sim \\text{Bernoulli}(\\theta)$, the probability that you like the bubble tea is simply:\n$$\nP(X = 1) = \\theta = 0.86.\n$$\n\nb. Let $Y$ denote whether you or your friend like the bubble tea. Assume the two events are independent. The probability that at least one of you likes the bubble tea is given by:\n\\begin{align*}\n\\Pr(Y \\geq 1) \n&= 1 - P(\\text{neither likes it}) \\\\\n&= 1 - P(X_1 = 0)P(X_2 = 0),\n\\end{align*}\nwhere $X_1$ and $X_2$ represent your and your friend’s preferences, respectively. \nSubstituting the values:\n\\begin{align*}\nP(Y \\geq 1) \n&= 1 - (1 - \\theta)(1 - \\theta) \\\\\n&= 1 - (1 - 0.86)^2 \\\\\n&= 1 - 0.14^2 \\\\\n&= 1 - 0.0196 \\\\\n&= 0.9804.\n\\end{align*}\nThus, there is approximately a 98.04% chance that at least one of you will like the bubble tea.\n\nc. If you invite your entire family of size $n$, the number of people who like the bubble tea $S$ is known to follow a Binomial distribution:\n$$\nS \\sim \\text{Binomial}(n, \\theta).\n$$\nUsing properties of the Binomial distribution, the expected value of a Binomial random variable is given by:\n$$\nE(S) = n\\theta.\n$$\nSubstituting the values:\n$$\nE(S) = 0.86n.\n$$\n\n:::\n\n::: {.callout-warning}\n### Assumptions\nIn part (b) above, we came to the solution by assuming that you and your friend have the same probability of liking the tea. In other words, your preferences are independent of each other^[Non-independence could be you liking whatever your friend likes! You know, becase you're BFFs.].\n\nIn fact, for the binomial distribution, this same assumption must be met for all your family members.\n:::\n\n\n## A statistical example\n\nSuppose you’re hired by a new boba tea shop, *Pearl Paradise*, to determine whether their signature drink is as good as their rival’s, *Tapioca Treasure*.\n\n::: {#fig-bobatea layout-ncol=2}\n![Pearl Paradise](figures/pearlparadise.png){#fig-pearlparadise}\n\n![Tapioca Treasure](figures/tapiocatreasure.png){#fig-tapiocatreasure}\n\nBoba tea companies.\n:::\n\nThe questions we have to answer are:\n\n::: {#exr-pearlparadise}\n\na. What is the rating ($\\theta$) for Pearl Paradise?\nb. Is $\\theta = 0.86$ or not?\nc. How confident are we in our estimate?\n\n:::\n\nNotice how these questions are fundamentally different from the previous questions.\nPrevious calculations are \"straightforward\" if you know probabilities and distribution theory, since the $\\theta$ value is given.\nHere, you're dealing with the fact that the $\\theta$ values is **unknown**, and somehow is the focus of attention.\n\nThe other thing you might realise is that there is no way of answering the questions *without having data points* to infer from.\nThis is the difference between statistics and probability.\nThe above three questions implicitly describe the three main activities concerning statistical inference: 1. Point estimation; 2. Hypothesis testing; and 3. Interval estimation.\n\n\nFor now, let us assume that we may collect some data, to at least answer the first part (a).\nYou conduct a survey of 10 random individuals, and ask them the question \"Do you like the bubble tea from Pearl Paradise?\".\nHere are the responses to the survey:\n\n\n\n\n\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nn <- 10\ntheta_pp <- 0.8  # PRETEND YOU DON'T KNOW THIS\n\nX <- rbinom(n = n, size = 1, prob = theta_pp)\nX\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n [1] 1 1 1 1 1 1 1 1 0 1\n```\n\n\n:::\n:::\n\n\n\n\n\n\n\n\n\n\nLet us denote $X_i$ to be the response for individual $i$ to the survey.\nSo in the above, $X_1 = 1$, $X_2 = 1$, and so on.\nThe assumption we make here, similar to the probability question above, is that $X_i\\sim\\text{Bern}(\\theta)$ independently. \nLet’s now work through the solutions:\n\n::: {#sol-pearlparadise}\n\na. If $\\theta$ represents the proportion of people who like the bubble tea from Pearl Paradise, it would make sense to count the number of people who like the bubble tea, and divide by the total number of responses. Mathematically,\n$$\n\\frac{1}{n} (X_1 + \\dots + X_n) = \\frac{1}{n} \\sum_{i=1}^n X_i = \\bar X_n\n$$\nSo we plug in the numbers and get $\\bar X_n = 9 / 10 = 0.9$. \n\n\n:::\n\nWe often denote the *estimate* of $\\theta$ by its hat version, so we often write\n$$\n\\hat\\theta = 0.9.\n$$\n\n\n## Variability in your answer\n\n\n![](figures/00-popsample.png)\n\nI am sure you notice, that the estimate $\\hat\\theta$ will depend on *who you ask* in the survey.\nIn the context of Pearl Paradise, the population represents all potential customers who could provide their opinion about the boba tea, while the sample refers to the subset of individuals surveyed. \n\nConsider a *random sample* of size $n$ (in the example above, $n=10$):\n$$\n\\mathcal S = \\{X_1,\\dots,X_n\\}.\n$$\nHere $X_i$ are concrete numbers or data regarding the population which is pertinent to answer your statistical question.\nIn statistical inference, we use the sample data to estimate characteristics of the population, such as the proportion of customers who like Pearl Paradise’s boba tea. \nSince it is often impractical to survey the entire population, we rely on the sample to draw conclusions, recognizing that there is uncertainty due to sampling variability.\n\n\nOf course, a lot of things can influence this, such as demographics, time period, circumstances, non-response rates, etc. -- and there's a lot of work to ensure \"representativeness\" of a sample, but our course does not deal with this.\n\n\nBut even if all things perfect, there is inherent randomness due to sampling itself.\nWe can simulate this by repeatedly conducting the survey of 10 people.\nHere are the results:\n\n\n\n\n\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nB <- 20  # number of repeated surveys\nres <- list()\nfor (i in 1:B) {\n  res[[i]] <- rbinom(n = n, size = 1, prob = theta_pp)\n}\n\ntab <-\n  tibble(\n    survey = 1:B,\n    X = res\n  ) |>\n  mutate(\n    theta_hat = sapply(X, mean),\n    X = sapply(X, \\(x) paste0(x, collapse = \",\"))\n  )\n\ngt(tab) |>\n  fmt_markdown() |>\n  cols_label(\n    survey ~ \"Survey no.\",\n    theta_hat ~ gt::md(\"$\\\\hat\\\\theta$\")\n  ) |>\n  tab_options(quarto.disable_processing = TRUE)\n```\n\n::: {.cell-output-display}\n\\begin{table}\n\\fontsize{12.0pt}{14.4pt}\\selectfont\n\\begin{tabular*}{\\linewidth}{@{\\extracolsep{\\fill}}rrr}\n\\toprule\nSurvey no. & X & \\(\\hat\\theta\\) \\\\ \n\\midrule\\addlinespace[2.5pt]\n1 & 1,1,1,1,1,1,1,0,1,1 & 0.9 \\\\ \n2 & 1,1,0,0,1,1,1,1,1,0 & 0.7 \\\\ \n3 & 1,1,0,1,1,0,1,1,1,1 & 0.8 \\\\ \n4 & 1,1,1,0,0,1,1,0,1,1 & 0.7 \\\\ \n5 & 1,0,1,0,1,0,1,1,1,1 & 0.7 \\\\ \n6 & 1,1,1,1,1,1,1,0,1,1 & 0.9 \\\\ \n7 & 1,1,1,1,1,1,0,1,1,1 & 0.9 \\\\ \n8 & 1,1,1,0,1,0,1,0,1,1 & 0.7 \\\\ \n9 & 1,1,0,1,1,1,1,1,1,1 & 0.9 \\\\ \n10 & 1,1,1,1,1,1,1,1,1,1 & 1 \\\\ \n11 & 0,0,1,1,1,1,1,1,1,0 & 0.7 \\\\ \n12 & 1,1,1,1,0,1,1,1,0,1 & 0.8 \\\\ \n13 & 1,1,1,1,1,1,1,1,1,1 & 1 \\\\ \n14 & 1,1,1,1,1,1,1,1,0,0 & 0.8 \\\\ \n15 & 1,1,1,1,1,1,0,1,1,0 & 0.8 \\\\ \n16 & 1,1,1,1,1,1,1,1,1,1 & 1 \\\\ \n17 & 1,1,1,0,1,1,1,1,1,1 & 0.9 \\\\ \n18 & 1,1,1,1,1,1,1,1,1,0 & 0.9 \\\\ \n19 & 0,1,1,0,1,1,0,0,1,1 & 0.6 \\\\ \n20 & 1,1,1,0,1,1,1,0,1,1 & 0.8 \\\\ \n\\bottomrule\n\\end{tabular*}\n\\end{table}\n\n:::\n:::\n\n\n\n\n\n\n\n\n\n\nSuppose we conducted more and more of the surveys, we could even get more information regarding *the variability of the estimator*.\nIdeally, we could even plot a histogram to show the *distribution* of the estimator.\n\n\n\n\n\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nB <- 100000  # number of repeated surveys\ntheta_hats <- c()\nfor (i in 1:B) {\n  theta_hats[i] <- mean(rbinom(n = n, size = 1, prob = theta_pp))\n}\n\ntibble(\n  theta_hat = theta_hats\n) |>\n  ggplot(aes(x = theta_hat)) +\n  geom_histogram(fill = \"lightblue\", col = \"black\", binwidth = 0.05) +\n  scale_x_continuous(breaks = seq(0, 1, by = 0.1))\n```\n\n::: {.cell-output-display}\n![Histogram of estimated $\\hat\\theta$ values in repeated sampling of 100,000 surveys.](index_files/figure-pdf/fig-variabilityestimator-1.pdf){#fig-variabilityestimator fig-pos='H'}\n:::\n:::\n\n\n\n\n\n\n\n\n\n\nIn @fig-variabilityestimator above, it is really evident that under repeated sampling, it is obvious to pick \"the best\" estimator value $\\hat\\theta$, say, by choosing the value corresponding to the highest bar.\n\nBut we cannot \"do\" repeated sampling most of the time. \nIt is too tiresome, expensive, and just not feasible or impossible sometimes! (Think clinical trials... can you repeat the trial 10,000 times?!).\nCan we still do something about it then? Yes! \nBy studying statistics from a mathematical angle, we can come up with neat results to come up with reliable statements about the variability of estimators.\n\n::: {.callout-tip}\n### Take aways\n\n1. Estimators (such as $\\hat\\theta=\\bar X_n$) are functions of random variables, and therefore **are themselves random** (i.e. have variability).\n\n2. Figuring out the distribution of estimators is the [central idea]{.ul} around statistics.\n\n3. From the distribution of $\\hat\\theta$, we can know\n   a. $\\E(\\hat\\theta)$ -- the average value to expect.\n   b. $\\Var(\\hat\\theta)$ -- how variable is my estimator?\n   c. $\\Pr(a < \\hat\\theta b)$ -- how confident am I that my estimator lies in a certain interval?\n\n:::\n\n \n\n## Probability vs statistics\n\n\n::: {.columns}\n\n::: {.column width=48%}\n\n\n\n\n\n\n\n\n\n\n::: {.cell}\n\n```{.tex .cell-code}\n\\usetikzlibrary{fit,positioning,shapes.geometric,decorations.pathreplacing,calc}\n\\begin{tikzpicture}[scale=0.8, transform shape]\n\\tikzstyle{obsvar}=[rectangle, thick, minimum size = 10mm,draw =black!80, node distance = 1mm]\n\\tikzstyle{connect}=[-latex, thick]\n\n\\node[obsvar] (fx) [] {$\\hspace{1em}f(x|\\theta)\\hspace{1em}$};\n\\node (xx) [right=of fx] {\\textcolor{blue}{$\\{X_1,\\dots,X_n\\}$}};\n\\node (theta) [left=of fx] {\\textcolor{red}{$\\theta$}};\n\\node (d1) [below=of fx,yshift=9mm] {Model};\n\\node (d2) [below=of xx,yshift=11mm] {\\scriptsize \\textcolor{blue}{prob.}};\n\\node (d3) [below=of theta,yshift=11mm] {\\scriptsize \\textcolor{red}{param.}};\n\\node (d1) [above=of fx,yshift=-5mm] {\\underline{Probability}};\n\n\\path (fx) edge [connect] (xx)\n      (theta) edge [connect] (fx);\n\n\\end{tikzpicture}\n```\n\n\n::: {.cell-output-display}\n![](index_files/figure-pdf/unnamed-chunk-6-1.pdf){fig-pos='H'}\n:::\n:::\n\n\n\n\n\n\n\n\n\n\n- What is $\\E(X)$?\n- What is $\\Pr(X > a)$?\n\n\n:::\n\n::: {.column width=48%}\n\n\n\n\n\n\n\n\n\n\n\n::: {.cell}\n\n```{.tex .cell-code}\n\\usetikzlibrary{fit,positioning,shapes.geometric,decorations.pathreplacing,calc}\n\\begin{tikzpicture}[scale=0.8, transform shape]\n\\tikzstyle{obsvar}=[rectangle, thick, minimum size = 10mm,draw =black!80, node distance = 1mm]\n\\tikzstyle{connect}=[-latex, thick]\n\\node[obsvar] (fx) [] {$\\hspace{1em}f(x|\\theta)\\hspace{1em}$};\n\\node (xx) [right=of fx] {\\textcolor{red}{$\\{x_1,\\dots,x_n\\}$}};\n\\node (theta) [left=of fx] {\\textcolor{blue}{$\\hat\\theta$}};\n\\node (d1) [below=of fx,yshift=9mm] {Model};\n\\node (d2) [below=of xx,yshift=11mm] {\\scriptsize \\textcolor{red}{data}};\n\\node (d3) [below=of theta,yshift=11mm] {\\scriptsize \\textcolor{blue}{est.}};\n\\node (d1) [above=of fx,yshift=-5mm] {\\underline{Statistics}};\n\n\\path (fx) edge [connect] (theta)\n      (xx) edge [connect] (fx);\n\n\\end{tikzpicture}\n```\n\n\n::: {.cell-output-display}\n![](index_files/figure-pdf/unnamed-chunk-7-1.pdf){fig-pos='H'}\n:::\n:::\n\n\n\n\n\n\n\n\n\n\n- What is $\\theta$?\n- Is $\\theta$ larger than $\\theta_0$?\n- How confident am I that $\\theta \\in (\\theta_l,\\theta_u)$?\n\n:::\n\n:::\n\n\n![](figures/00-probstats.jpeg){fig-align=center height=85%}",
    "supporting": [
      "index_files/figure-pdf"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {
      "knitr": [
        "{\"type\":\"list\",\"attributes\":{\"knit_meta_id\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"unnamed-chunk-4\",\"unnamed-chunk-4\",\"unnamed-chunk-4\",\"unnamed-chunk-4\",\"unnamed-chunk-4\",\"unnamed-chunk-4\",\"unnamed-chunk-4\"]}},\"value\":[{\"type\":\"list\",\"attributes\":{\"names\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"name\",\"options\",\"extra_lines\"]},\"class\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"latex_dependency\"]}},\"value\":[{\"type\":\"character\",\"attributes\":{},\"value\":[\"booktabs\"]},{\"type\":\"NULL\"},{\"type\":\"NULL\"}]},{\"type\":\"list\",\"attributes\":{\"names\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"name\",\"options\",\"extra_lines\"]},\"class\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"latex_dependency\"]}},\"value\":[{\"type\":\"character\",\"attributes\":{},\"value\":[\"caption\"]},{\"type\":\"NULL\"},{\"type\":\"NULL\"}]},{\"type\":\"list\",\"attributes\":{\"names\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"name\",\"options\",\"extra_lines\"]},\"class\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"latex_dependency\"]}},\"value\":[{\"type\":\"character\",\"attributes\":{},\"value\":[\"longtable\"]},{\"type\":\"NULL\"},{\"type\":\"NULL\"}]},{\"type\":\"list\",\"attributes\":{\"names\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"name\",\"options\",\"extra_lines\"]},\"class\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"latex_dependency\"]}},\"value\":[{\"type\":\"character\",\"attributes\":{},\"value\":[\"colortbl\"]},{\"type\":\"NULL\"},{\"type\":\"NULL\"}]},{\"type\":\"list\",\"attributes\":{\"names\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"name\",\"options\",\"extra_lines\"]},\"class\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"latex_dependency\"]}},\"value\":[{\"type\":\"character\",\"attributes\":{},\"value\":[\"array\"]},{\"type\":\"NULL\"},{\"type\":\"NULL\"}]},{\"type\":\"list\",\"attributes\":{\"names\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"name\",\"options\",\"extra_lines\"]},\"class\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"latex_dependency\"]}},\"value\":[{\"type\":\"character\",\"attributes\":{},\"value\":[\"anyfontsize\"]},{\"type\":\"NULL\"},{\"type\":\"NULL\"}]},{\"type\":\"list\",\"attributes\":{\"names\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"name\",\"options\",\"extra_lines\"]},\"class\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"latex_dependency\"]}},\"value\":[{\"type\":\"character\",\"attributes\":{},\"value\":[\"multirow\"]},{\"type\":\"NULL\"},{\"type\":\"NULL\"}]}]}"
      ]
    },
    "preserve": null,
    "postProcess": false
  }
}