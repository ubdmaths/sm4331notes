{
  "hash": "cfa463c4af234407edf5eb13babdb1e2",
  "result": {
    "engine": "knitr",
    "markdown": "\\usepackage{blkarray}\n\n\\newcommand{\\bzero}{{\\mathbf 0}}\n\\newcommand{\\bone}{{\\mathbf 1}}\n\\newcommand{\\ba}{{\\mathbf a}}\n\\newcommand{\\bb}{{\\mathbf b}}\n\\newcommand{\\bc}{{\\mathbf c}}\n\\newcommand{\\bd}{{\\mathbf d}}\n\\newcommand{\\be}{{\\mathbf e}}\n\\newcommand{\\bff}{{\\mathbf f}}\n\\newcommand{\\bg}{{\\mathbf g}}\n\\newcommand{\\bh}{{\\mathbf h}}\n\\newcommand{\\bi}{{\\mathbf i}}\n\\newcommand{\\bj}{{\\mathbf j}}\n\\newcommand{\\bk}{{\\mathbf k}}\n\\newcommand{\\bl}{{\\mathbf l}}\n\\newcommand{\\bmm}{{\\mathbf m}}\n\\newcommand{\\bn}{{\\mathbf n}}\n\\newcommand{\\bo}{{\\mathbf o}}\n\\newcommand{\\bp}{{\\mathbf p}}\n\\newcommand{\\bq}{{\\mathbf q}}\n\\newcommand{\\br}{{\\mathbf r}}\n\\newcommand{\\bs}{{\\mathbf s}}\n\\newcommand{\\bt}{{\\mathbf t}}\n\\newcommand{\\bu}{{\\mathbf u}}\n\\newcommand{\\bv}{{\\mathbf v}}\n\\newcommand{\\bw}{{\\mathbf w}}\n\\newcommand{\\bx}{{\\mathbf x}}\n\\newcommand{\\by}{{\\mathbf y}}\n\\newcommand{\\bz}{{\\mathbf z}}\n\\newcommand{\\bA}{{\\mathbf A}}\n\\newcommand{\\bB}{{\\mathbf B}}\n\\newcommand{\\bC}{{\\mathbf C}}\n\\newcommand{\\bD}{{\\mathbf D}}\n\\newcommand{\\bE}{{\\mathbf E}}\n\\newcommand{\\bF}{{\\mathbf F}}\n\\newcommand{\\bG}{{\\mathbf G}}\n\\newcommand{\\bH}{{\\mathbf H}}\n\\newcommand{\\bI}{{\\mathbf I}}\n\\newcommand{\\bJ}{{\\mathbf J}}\n\\newcommand{\\bK}{{\\mathbf K}}\n\\newcommand{\\bL}{{\\mathbf L}}\n\\newcommand{\\bM}{{\\mathbf M}}\n\\newcommand{\\bN}{{\\mathbf N}}\n\\newcommand{\\bO}{{\\mathbf O}}\n\\newcommand{\\bP}{{\\mathbf P}}\n\\newcommand{\\bQ}{{\\mathbf Q}}\n\\newcommand{\\bR}{{\\mathbf R}}\n\\newcommand{\\bS}{{\\mathbf S}}\n\\newcommand{\\bT}{{\\mathbf T}}\n\\newcommand{\\bU}{{\\mathbf U}}\n\\newcommand{\\bV}{{\\mathbf V}}\n\\newcommand{\\bW}{{\\mathbf W}}\n\\newcommand{\\bX}{{\\mathbf X}}\n\\newcommand{\\bY}{{\\mathbf Y}}\n\\newcommand{\\bZ}{{\\mathbf Z}}\n\\newcommand{\\balpha}{{\\boldsymbol\\alpha}}\n\\newcommand{\\bbeta}{{\\boldsymbol\\beta}}\n\\newcommand{\\bgamma}{{\\boldsymbol\\gamma}}\n\\newcommand{\\bdelta}{{\\boldsymbol\\delta}}\n\\newcommand{\\bepsilon}{{\\boldsymbol\\epsilon}}\n\\newcommand{\\bvarepsilon}{{\\boldsymbol\\varepsilon}}\n\\newcommand{\\bzeta}{{\\boldsymbol\\zeta}}\n\\newcommand{\\bfeta}{{\\boldsymbol\\eta}}\n\\newcommand{\\boldeta}{{\\boldsymbol\\eta}}\n\\newcommand{\\btheta}{{\\boldsymbol\\theta}}\n\\newcommand{\\bvartheta}{{\\boldsymbol\\vartheta}}\n\\newcommand{\\biota}{{\\boldsymbol\\iota}}\n\\newcommand{\\bkappa}{{\\boldsymbol\\kappa}}\n\\newcommand{\\blambda}{{\\boldsymbol\\lambda}}\n\\newcommand{\\bmu}{{\\boldsymbol\\mu}}\n\\newcommand{\\bnu}{{\\boldsymbol\\nu}}\n\\newcommand{\\bxi}{{\\boldsymbol\\xi}}\n\\newcommand{\\bpi}{{\\boldsymbol\\pi}}\n\\newcommand{\\bvarpi}{{\\boldsymbol\\varpi}}\n\\newcommand{\\brho}{{\\boldsymbol\\rho}}\n\\newcommand{\\bvarrho}{{\\boldsymbol\\varrho}}\n\\newcommand{\\bsigma}{{\\boldsymbol\\sigma}}\n\\newcommand{\\bvarsigma}{{\\boldsymbol\\varsigma}}\n\\newcommand{\\btau}{{\\boldsymbol\\tau}}\n\\newcommand{\\bupsilon}{{\\boldsymbol\\upsilon}}\n\\newcommand{\\bphi}{{\\boldsymbol\\phi}}\n\\newcommand{\\bvarphi}{{\\boldsymbol\\varphi}}\n\\newcommand{\\bchi}{{\\boldsymbol\\chi}}\n\\newcommand{\\bpsi}{{\\boldsymbol\\psi}}\n\\newcommand{\\bomega}{{\\boldsymbol\\omega}}\n\\newcommand{\\bGamma}{{\\boldsymbol\\Gamma}}\n\\newcommand{\\bDelta}{{\\boldsymbol\\Delta}}\n\\newcommand{\\bTheta}{{\\boldsymbol\\Theta}}\n\\newcommand{\\bLambda}{{\\boldsymbol\\Lambda}}\n\\newcommand{\\bXi}{{\\boldsymbol\\Xi}}\n\\newcommand{\\bPi}{{\\boldsymbol\\Pi}}\n\\newcommand{\\bSigma}{{\\boldsymbol\\Sigma}}\n\\newcommand{\\bUpsilon}{{\\boldsymbol\\Upsilon}}\n\\newcommand{\\bPhi}{{\\boldsymbol\\Phi}}\n\\newcommand{\\bPsi}{{\\boldsymbol\\Psi}}\n\\newcommand{\\bOmega}{{\\boldsymbol\\Omega}}\n\\DeclareMathOperator{\\diag}{diag}\n\\DeclareMathOperator{\\Prob}{P}\n\\DeclareMathOperator{\\E}{E}\n\\DeclareMathOperator{\\Var}{Var}\n\\DeclareMathOperator{\\Cov}{Cov}\n\\DeclareMathOperator{\\Corr}{Corr}\n\\DeclareMathOperator{\\sd}{sd}\n\\DeclareMathOperator{\\se}{se}\n\\DeclareMathOperator{\\N}{N}\n\\DeclareMathOperator{\\Bin}{Bin}\n\\DeclareMathOperator{\\Bern}{Bern}\n\\DeclareMathOperator{\\Dir}{Dir}\n\\DeclareMathOperator{\\Wis}{Wis}\n\\DeclareMathOperator{\\logit}{logit}\n\\DeclareMathOperator{\\expit}{expit}\n\\DeclareMathOperator{\\Mult}{Mult}\n\\DeclareMathOperator{\\Cat}{Cat}\n\\DeclareMathOperator{\\Pois}{Poi}\n\\DeclareMathOperator{\\Geom}{Geom}\n\\DeclareMathOperator{\\NBin}{NBin}\n\\DeclareMathOperator{\\Exp}{Exp}\n\\DeclareMathOperator{\\Betadist}{Beta}\n\\DeclareMathOperator{\\Hypergeom}{Hypergeom}\n\\DeclareMathOperator{\\Cauchy}{Cauchy}\n\\DeclareMathOperator{\\hCauchy}{half-Cauchy}\n\\DeclareMathOperator{\\LKJ}{LKJ}\n\\DeclareMathOperator{\\Unif}{Unif}\n\\DeclareMathOperator{\\KL}{KL}\n\\DeclareMathOperator{\\ind}{\\mathds{1}}\n\\newcommand{\\iid}{\\,\\overset{\\text{iid}}{\\sim}\\,}\n\\DeclareMathOperator*{\\plim}{plim}\n\\DeclareMathOperator{\\Lik}{L}\n\\DeclareMathOperator{\\argmax}{argmax}\n\\DeclareMathOperator{\\vecc}{vec}\n\\DeclareMathOperator{\\dd}{d}\n\\newcommand{\\dint}{\\dd\\hspace{0.5pt}\\!}\n\n\\newcommand{\\bbR}{\\mathbb{R}}\n\\newcommand{\\bbN}{\\mathbb{N}}\n\\newcommand{\\bbZ}{\\mathbb{Z}}\n\\newcommand{\\bbC}{\\mathbb{C}}\n\\newcommand{\\bbS}{\\mathbb{S}}\n\\newcommand{\\bbH}{\\mathbb{H}}\n\\newcommand{\\bbP}{\\mathbb{P}}\n\n\\newcommand{\\cA}{{\\mathcal A}}\n\\newcommand{\\cB}{{\\mathcal B}}\n\\newcommand{\\cC}{{\\mathcal C}}\n\\newcommand{\\cD}{{\\mathcal D}}\n\\newcommand{\\cE}{{\\mathcal E}}\n\\newcommand{\\cF}{{\\mathcal F}}\n\\newcommand{\\cG}{{\\mathcal G}}\n\\newcommand{\\cH}{{\\mathcal H}}\n\\newcommand{\\cI}{{\\mathcal I}}\n\\newcommand{\\cJ}{{\\mathcal J}}\n\\newcommand{\\cK}{{\\mathcal K}}\n\\newcommand{\\cL}{{\\mathcal L}}\n\\newcommand{\\cM}{{\\mathcal M}}\n\\newcommand{\\cN}{{\\mathcal N}}\n\\newcommand{\\cO}{{\\mathcal O}}\n\\newcommand{\\cP}{{\\mathcal P}}\n\\newcommand{\\cQ}{{\\mathcal Q}}\n\\newcommand{\\cR}{{\\mathcal R}}\n\\newcommand{\\cS}{{\\mathcal S}}\n\\newcommand{\\cT}{{\\mathcal T}}\n\\newcommand{\\cU}{{\\mathcal U}}\n\\newcommand{\\cV}{{\\mathcal V}}\n\\newcommand{\\cW}{{\\mathcal W}}\n\\newcommand{\\cX}{{\\mathcal X}}\n\\newcommand{\\cY}{{\\mathcal Y}}\n\\newcommand{\\cZ}{{\\mathcal Z}}\n\n\\newcommand{\\myoverbrace}[3][gray]{{\\color{#1}\\overbrace{\\color{black}#2}^{#3}}}\n\\newcommand{\\myunderbrace}[3][gray]{{\\color{#1}\\underbrace{\\color{black}#2}_{#3}}}\n\n\\renewcommand{\\Pr}{\\operatorname{P}}\n\n\n\n\n\n\n\n\n\n\n\n\n# Commonly used probability models\n\n## Poisson-Binomial relationship\n\nThe Poisson distribution plays a useful approximation role for the binomial:\n$$\nX\\sim\\Bin(n,p) \\ \\ \\Rightarrow \\ \\ X \\approx \\Pois(np)\n$$\nwhen $n$ is large ($n>20$) and $np$ is small ($np<5$). \nThe reason is the Poisson can be seen as the *limiting case* to the binomial as $n\\to\\infty$ while $\\E(X)=np$ remains fixed.\n\n\\begin{align*}\n\\lim_{n\\to\\infty} \\Pr(X=x)\n&= \\lim_{n\\to\\infty} \\frac{n!}{x!(n-x)!}\\left(\\frac{\\lambda}{n} \\right)^x \\left(1 - \\frac{\\lambda}{n} \\right)^{n-x} \\\\\n&= \\frac{\\lambda^x}{x!} \\lim_{n\\to\\infty}\n\\myunderbrace{\\frac{n!}{n^x(n-x)!}}{\\to 1}\n\\,\n\\myunderbrace{\\left(1 - \\frac{\\lambda}{n} \\right)^n}{\\to e^{-\\lambda}}\n\\,\n\\myunderbrace{\\left(1 - \\frac{\\lambda}{n} \\right)^{-x}}{\\to 1} \\\\\n&=  \\frac{e^{-\\lambda}\\lambda^x}{x!} \\\\\n&= \\Pr(Y=x), Y\\sim\\Pois(\\lambda).\n\\end{align*}\n\n\nThe reason is that the Poisson can be seen as the *limiting case* to the binomial as $n\\to\\infty$ while $\\E(X)=np$ remains fixed.\n\n\n\n\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse)\npoibin_df <- function(n, p, x = 0:10) {\n  lambda <- n * p\n  the_title <- paste0(\"n = \", n, \", p = \", p)\n  \n  tibble(\n    x = x,\n    bin = dbinom(x, size = n, prob = p),\n    poi = dpois(x, lambda = n * p)\n  ) %>%\n    pivot_longer(-x) %>%\n    mutate(title = the_title)\n}\n\nplot_df <- bind_rows(\n  poibin_df(20, 0.05),\n  poibin_df(10, 0.3),\n  poibin_df(100, 0.3, 20:30),\n  poibin_df(1000, 0.01)\n) \nmylevels <- unique(plot_df$title)\nplot_df$title <- factor(plot_df$title, levels = mylevels)\n# levels(plot_df$title) <- mylevels\n  \nggplot(plot_df, aes(x, value, fill = name)) +\n  geom_bar(stat = \"identity\", position = \"dodge\", alpha = 0.7) +\n  facet_wrap(. ~ title, ncol = 2, scales = \"free\") +\n  scale_x_continuous(breaks = 0:100) +\n  # scale_fill_manual(values = c(palgreen, palred)) +\n  labs(y = \"P(X=x)\", col = NULL, fill = NULL) +\n  theme(legend.position = \"top\")\n```\n\n::: {.cell-output-display}\n![](chapter2_files/figure-html/fig-poisbin-1.png){#fig-poisbin width=672}\n:::\n:::\n\n\n\n\n\n\n\n\n\n## Memoryless property\n\n$X$ is a positive rv and memoryless, in the sense that for all $t>s>0$,\n$$\n\\Pr(X > t+s \\mid X>s) = \\Pr(X > t)\n$$\nif and only if it is exponentially distributed^[https://perplex.city/memorylessness-at-the-bus-stop-f2c97c59e420?gi=3602158da66b].\n\n> Given that we have been waiting for $s$ units of time, the probability that we wait a further $t$ units of time is independent to the first fact!\n\n\n::: {#exm-memoryless}\nAssume that bus waiting times are exponentially distributed, and you are concerned about the event $A=$ a bus arrives in the next minute.\nLet $p_i = \\Pr(A|B_i)$ where\n\ni. $B_1 =$ you just arrived to the station; and\nii. $B_2 =$ you've been sitting there for 20 minutes already.\n\nThen $p_1=p_2$.\n:::\n\n\n\n## Relationships\n\n![Relationships among various univariate distributions.](figures/dist_rel.png){#fig-dist-rel}",
    "supporting": [
      "chapter2_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}