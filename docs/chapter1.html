<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.39">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>1&nbsp; Probability Theory Primer – SM-4331 Advanced Statistics</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./chapter2.html" rel="next">
<link href="./index.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-e26003cea8cd680ca0c55a263523d882.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-626149efe8f5d16e1d391ba177679bf0.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script src="site_libs/quarto-contrib/glightbox/glightbox.min.js"></script>
<link href="site_libs/quarto-contrib/glightbox/glightbox.min.css" rel="stylesheet">
<link href="site_libs/quarto-contrib/glightbox/lightbox.css" rel="stylesheet">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script async="" src="https://hypothes.is/embed.js"></script>
<script>
  window.document.addEventListener("DOMContentLoaded", function (_event) {
    document.body.classList.add('hypothesis-enabled');
  });
</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./chapter1.html"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Probability Theory Primer</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">SM-4331 Advanced Statistics</a> 
        <div class="sidebar-tools-main">
    <div class="dropdown">
      <a href="" title="Download" id="quarto-navigation-tool-dropdown-0" class="quarto-navigation-tool dropdown-toggle px-1" data-bs-toggle="dropdown" aria-expanded="false" role="link" aria-label="Download"><i class="bi bi-download"></i></a>
      <ul class="dropdown-menu" aria-labelledby="quarto-navigation-tool-dropdown-0">
          <li>
            <a class="dropdown-item sidebar-tools-main-item" href="./SM-4331-Advanced-Statistics.pdf">
              <i class="bi bi-file-pdf pe-1"></i>
            Download PDF
            </a>
          </li>
          <li>
            <a class="dropdown-item sidebar-tools-main-item" href="./SM-4331-Advanced-Statistics.docx">
              <i class="bi bi-file-word pe-1"></i>
            Download Docx
            </a>
          </li>
          <li>
            <a class="dropdown-item sidebar-tools-main-item" href="./SM-4331-Advanced-Statistics.epub">
              <i class="bi bi-journal pe-1"></i>
            Download ePub
            </a>
          </li>
      </ul>
    </div>
  <a href="" class="quarto-reader-toggle quarto-navigation-tool px-1" onclick="window.quartoToggleReader(); return false;" title="Toggle reader mode">
  <div class="quarto-reader-toggle-btn">
  <i class="bi"></i>
  </div>
</a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Preface</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chapter1.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Probability Theory Primer</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chapter2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Commonly used probability models</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chapter3.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Sampling from the normal distribution</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chapter4.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Large sample approximations</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chapter5.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Likelihood theory</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chapter6.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Hypothesis testing</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chapter7.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Interval estimation</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#algebras-of-sets" id="toc-algebras-of-sets" class="nav-link active" data-scroll-target="#algebras-of-sets"><span class="header-section-number">1.1</span> Algebras of sets</a></li>
  <li><a href="#why-sigma-algebra" id="toc-why-sigma-algebra" class="nav-link" data-scroll-target="#why-sigma-algebra"><span class="header-section-number">1.2</span> Why <span class="math inline">\(\sigma\)</span>-algebra?</a>
  <ul class="collapse">
  <li><a href="#rules-of-probability" id="toc-rules-of-probability" class="nav-link" data-scroll-target="#rules-of-probability"><span class="header-section-number">1.2.1</span> Rules of probability</a></li>
  <li><a href="#the-need-for-measure-theory" id="toc-the-need-for-measure-theory" class="nav-link" data-scroll-target="#the-need-for-measure-theory"><span class="header-section-number">1.2.2</span> The need for measure theory</a></li>
  </ul></li>
  <li><a href="#an-unmeasurable-set" id="toc-an-unmeasurable-set" class="nav-link" data-scroll-target="#an-unmeasurable-set"><span class="header-section-number">1.3</span> An unmeasurable set</a></li>
  <li><a href="#conditional-probability" id="toc-conditional-probability" class="nav-link" data-scroll-target="#conditional-probability"><span class="header-section-number">1.4</span> Conditional probability</a></li>
  <li><a href="#bayesian-statistics" id="toc-bayesian-statistics" class="nav-link" data-scroll-target="#bayesian-statistics"><span class="header-section-number">1.5</span> Bayesian statistics</a></li>
  <li><a href="#probability-integral-transform" id="toc-probability-integral-transform" class="nav-link" data-scroll-target="#probability-integral-transform"><span class="header-section-number">1.6</span> Probability integral transform</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Probability Theory Primer</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    <div>
    <div class="quarto-title-meta-heading">Modified</div>
    <div class="quarto-title-meta-contents">
      <p class="date-modified">December 21, 2024</p>
    </div>
  </div>
    
  </div>
  


</header>


<section id="algebras-of-sets" class="level2" data-number="1.1">
<h2 data-number="1.1" class="anchored" data-anchor-id="algebras-of-sets"><span class="header-section-number">1.1</span> Algebras of sets</h2>
<p>This is the mathematical structure that allows us to <em>observe</em> and <em>measure</em> random events. Logically,</p>
<ol type="1">
<li><p>If an event <span class="math inline">\(A\)</span> can be observed, then its complement can be too. I.e. <span class="math inline">\(A \in {\mathcal F}\Rightarrow A^c \in {\mathcal F}\)</span>.</p></li>
<li><p>At least one outcome can be observed, i.e.&nbsp;<span class="math inline">\(\Omega \in {\mathcal F}\)</span>.</p></li>
<li><p>If two or more events are observed, then at least one of them (or both) can be observed, i.e. <span class="math display">\[
A,B \in {\mathcal F}\Rightarrow A \cup B \in {\mathcal F}
\]</span></p></li>
</ol>
<p>If 1–3 holds, then <span class="math inline">\({\mathcal F}\)</span> is said to be an <em>algebra</em> over <span class="math inline">\(\Omega\)</span>. In addition, if you can “add” up infinitely many countable things, <span class="math inline">\({\mathcal F}\)</span> is called a <em><span class="math inline">\(\sigma\)</span>-algebra</em>. <span class="math display">\[
A_1,A_2,\dots \in{\mathcal F}\Rightarrow \bigcup_{i=1}^\infty A_i \in {\mathcal F}
\]</span></p>
</section>
<section id="why-sigma-algebra" class="level2" data-number="1.2">
<h2 data-number="1.2" class="anchored" data-anchor-id="why-sigma-algebra"><span class="header-section-number">1.2</span> Why <span class="math inline">\(\sigma\)</span>-algebra?</h2>
<p>In probability theory and statistics, an experiment (or trial) is a procedure that can be repeated and has a well-defined set of possible outcomes (known as the sample space <span class="math inline">\(\Omega\)</span>). Events are thought of as being subsets of <span class="math inline">\(\Omega\)</span>, while probabilities are merely a mapping from some <em>event space</em> <span class="math inline">\(\mathcal F\)</span> to <span class="math inline">\([0,1]\)</span>.</p>
<p>To make this idea concrete, for the die roll example, <span class="math inline">\(\Omega=\{1,\dots,6\}\)</span>, while an event could be <span class="math inline">\(E=\{2,4,6\}\subset \Omega\)</span> (getting an even number). The probability of the event <span class="math inline">\(E\)</span> occurring is <span class="math inline">\(\operatorname{P}(E)=\frac{1}{2}\)</span>–so it indeed behaves like a function, taking input some event and spitting out a number between 0 and 1.</p>
<p>Note here that <span class="math inline">\(\mathcal F\)</span> is not <span class="math inline">\(\Omega\)</span>–it has to be bigger than <span class="math inline">\(\Omega\)</span> as we’re not just interested in singleton outcomes. A good starting point would be <span class="math inline">\(\mathcal F = \mathcal P(\Omega)\)</span>, the set of all subsets of <span class="math inline">\(\Omega\)</span>, which should contain all possible events constructed from the set of outcomes.</p>
<section id="rules-of-probability" class="level3" data-number="1.2.1">
<h3 data-number="1.2.1" class="anchored" data-anchor-id="rules-of-probability"><span class="header-section-number">1.2.1</span> Rules of probability</h3>
<p>Having abstracted the notion of <span class="math inline">\(\Omega\)</span> and <span class="math inline">\(\mathcal F\)</span>, we should also define some rules that the probability function <span class="math inline">\(\operatorname{P}:\mathcal P(\Omega)\to[0,1]\)</span> must follow. Let us list down a few:</p>
<ol type="i">
<li><span class="math inline">\(\operatorname{P}(E) \geq 0, \forall E\)</span>;</li>
<li><span class="math inline">\(\operatorname{P}(\varnothing)=0\)</span> and <span class="math inline">\(\operatorname{P}(\Omega) = 1\)</span>;<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a></li>
<li>If <span class="math inline">\(E_1 \cap E_2 = \varnothing\)</span>, then <span class="math inline">\(\operatorname{P}(E_1 \cup E_2)=\operatorname{P}(E_1) + \operatorname{P}(E_2)\)</span>; and</li>
<li>If <span class="math inline">\(E_1, E_2,\dots\)</span> are mutually disjoint events, then <span class="math inline">\(\operatorname{P}\Big(\bigcup_{i=1}^\infty E_i \Big) = \sum_{i=1}^\infty \operatorname{P}(E_i)\)</span>.</li>
</ol>
<p>Indeed, these are quite logical impositions that ensure we don’t end up with nonsensical probabilities. For instance, by ii. and iii., modelling a (biased) coin toss by <span class="math inline">\(\operatorname{P}(H)=0.7\)</span> necessitates <span class="math inline">\(\operatorname{P}(T)=0.3\)</span> and not anything else, e.g.&nbsp;<span class="math inline">\(\operatorname{P}(T)=0.5\)</span>.</p>
</section>
<section id="the-need-for-measure-theory" class="level3" data-number="1.2.2">
<h3 data-number="1.2.2" class="anchored" data-anchor-id="the-need-for-measure-theory"><span class="header-section-number">1.2.2</span> The need for measure theory</h3>
<p>We’ve managed to come up with probability rules so far without the need for measure theory, so what’s the problem? The problem is that in the way that we’ve described it, this is actually too much to ask! There will be instances where this whole framework fails and we can’t assign probabilities properly, especially when we need it the most.</p>
<p>Consider that, with all these demands, we can’t even define the uniform random variable on <span class="math inline">\(\Omega=[0,1]\)</span>! That is, no mapping <span class="math inline">\(\operatorname{P}:\mathcal P([0,1])\to[0,1]\)</span> exists such that <span class="math inline">\(\operatorname{P}([a,b])=b-a\)</span> for <span class="math inline">\(0\leq a \leq b \leq 1\)</span> which satisfies all of the rules i. to iv. listed above. For a proof, see the appendix. Evidently some concession has to be made (which one?), and the probability map must be constructed more carefully. The answer lies in measure theory.</p>
</section>
</section>
<section id="an-unmeasurable-set" class="level2" data-number="1.3">
<h2 data-number="1.3" class="anchored" data-anchor-id="an-unmeasurable-set"><span class="header-section-number">1.3</span> An unmeasurable set</h2>
<p>As mentioned, we are unable to define a uniform probability measure on the unit interval, given by <span class="math display">\[
\operatorname{P}([a,b]) = b-a
\]</span> that satisfies all the probability rules listed in i. to iv. earlier. On the face of it, all the rules themselves are satisfied: <span class="math inline">\(\operatorname{P}(\Omega)=\operatorname{P}([0,1])=1\)</span>, <span class="math inline">\(\operatorname{P}(\varnothing)=\operatorname{P}([a,a])=0\)</span> (for any <span class="math inline">\(a\in[0,1]\)</span>), and certainly probabilities of disjoint subsets of <span class="math inline">\([0,1]\)</span> are just the sum of the lengths of the intervals.</p>
<p>These are all great properties to have, so we must concede instead on the domain of the probability function, i.e.&nbsp;the event space. The proof of the proposition below in instructive, in that it illustrates the existence of a “non-measurable” set. That is, there are such events (subsets in <span class="math inline">\([0,1]\)</span>) for which we are unable to assign probabilities to.</p>
<div id="prp-measure-theory" class="theorem proposition">
<p><span class="theorem-title"><strong>Proposition 1.1</strong></span> There does not exist a definition of <span class="math inline">\(\operatorname{P}:\mathcal P([0,1])\to[0,1]\)</span> satisfying <span class="math inline">\(\operatorname{P}([a,b])=b-a\)</span> and i. to iv. (as listed earlier).</p>
</div>
<div class="proof">
<p><span class="proof-title"><em>Proof</em>. </span>All we need to show is the existence of one such subset of <span class="math inline">\([0,1]\)</span> whose measure is undefined. The set we are about to construct is called the Vitali set<a href="#fn2" class="footnote-ref" id="fnref2" role="doc-noteref"><sup>2</sup></a>, after Giuseppe Vitali who described it in 1905.</p>
<p>Before proceeding, we introduce some notation. For a uniform measure on <span class="math inline">\([0,1]\)</span>, one expects that the measure of some subset <span class="math inline">\(A \subseteq [0,1]\)</span> to be unaffected by “shifting” (with wrap-around) of that subset by some fixed amount <span class="math inline">\(r\in[0,1]\)</span>. Define the <em><span class="math inline">\(r\)</span>-shift</em> of <span class="math inline">\(A\subseteq [0,1]\)</span> by <span class="math display">\[
A \oplus r := \left\{ a + r \mid a \in A, a+r \leq 1 \right\} \cup \left\{ a + r - 1 \mid a \in A, a+r &gt; 1 \right\}.
\]</span> Then we should have <span class="math display">\[
\operatorname{P}(A \oplus r) = \operatorname{P}(A).
\]</span> For example, <span class="math inline">\(\operatorname{P}([0.7, 0.9] \oplus 0.2) = \operatorname{P}([0.9,1] \cup [0,0.1]) = 0.2\)</span>.</p>
<p>Now, define an equivalence relation on <span class="math inline">\([0,1]\)</span> by the following: <span class="math display">\[x\sim y \Rightarrow y-x \in \mathbb Q\]</span> That is, two real numbers <span class="math inline">\(x\)</span> and <span class="math inline">\(y\)</span> are deemed to be similar if their difference is a rational number. The intent is to segregate all the real numbers <span class="math inline">\(x\in[0,1]\)</span> by this equivalence relation, and collect them into groups called equivalence classes, denoted by <span class="math inline">\([x]\)</span>. Here, <span class="math inline">\([x]\)</span> is the set <span class="math inline">\(\{y \in [0,1] \mid x \sim y\}.\)</span> For instance,</p>
<ul>
<li><p>The equivalence class of <span class="math inline">\(0\)</span> is the set of real numbers <span class="math inline">\(x\)</span> such that <span class="math inline">\(x \sim 0\)</span>, i.e.&nbsp;<span class="math inline">\([0] = \{y \in [0,1] \mid y-0\in\mathbb Q \}\)</span>, which is the set of all rational numbers in <span class="math inline">\([0,1]\)</span>.</p></li>
<li><p>The equivalence class of an irrational number <span class="math inline">\(z_1\in[0,1]\)</span> is clearly not in <span class="math inline">\([0]\)</span>, thus would represent a different equivalence class <span class="math inline">\([z_1]=\{y \in [0,1] \mid y-z_1 \in \mathbb Q \}\)</span>.</p></li>
<li><p>Yet another irrational number <span class="math inline">\(z_2\not\in [z_1]\)</span> would exist, i.e.&nbsp;a number <span class="math inline">\(z_2\in[0,1]\)</span> such that <span class="math inline">\(z_2-z_1 \not\in\mathbb Q\)</span>, and thus would represent a different equivalence class <span class="math inline">\([z_2]\)</span>.</p></li>
<li><p>And so on…</p></li>
</ul>
<p>The equivalence classes may therefore be represented by <span class="math inline">\([0],[z_1],[z_2],\dots\)</span> where <span class="math inline">\(z_i\)</span> are all irrational numbers that differ by an irrational number, and there are uncountably many such numbers, and therefore classes.</p>
<p>Construct the Vitali set <span class="math inline">\(V\)</span> as follows: Take precisely one element from each equivalent class, and put it in <span class="math inline">\(V\)</span>. As a remark, such a <span class="math inline">\(V\)</span> must surely exist by the Axiom of Choice<a href="#fn3" class="footnote-ref" id="fnref3" role="doc-noteref"><sup>3</sup></a>.</p>
<p>Consider now the union of shifted Vitali sets by some rational value <span class="math inline">\(r\in[0,1]\)</span>, <span class="math display">\[
\bigcup_{r} (V \oplus r)
\]</span> As a reminder, the set of rational numbers is countably infinite<a href="#fn4" class="footnote-ref" id="fnref4" role="doc-noteref"><sup>4</sup></a>. We make two observations:</p>
<ol type="1">
<li><p><strong>The equivalence relation partitions the interval <span class="math inline">\([0,1]\)</span> into a disjoint union of equivalence classes.</strong> In other words, the sets <span class="math inline">\((V \oplus r)\)</span> and <span class="math inline">\((V \oplus s)\)</span> are disjoint for any rationals <span class="math inline">\(r\neq s\)</span>, such that <span class="math inline">\(r,s\in[0,1]\)</span>. If they were not disjoint, this would mean that there exists some <span class="math inline">\(x,y\in[0,1]\)</span> with <span class="math inline">\(x+r\in(V \oplus r)\)</span> and <span class="math inline">\(y+s\in (V \oplus s)\)</span> such that <span class="math inline">\(x+r=y+s\)</span>. But then this means that <span class="math inline">\(x-y=s-r\in\mathbb Q\)</span> so <span class="math inline">\(x\)</span> and <span class="math inline">\(y\)</span> are in the same equivalent class, and this is a contradiction. Importantly, <span class="math display">\[\begin{equation}\label{eq:contr1}
\operatorname{P}\left(\bigcup_{r} (V \oplus r)\right) = \sum_r \operatorname{P}(V \oplus r) = \sum_r \operatorname{P}(V)
\end{equation}\]</span></p></li>
<li><p><strong>Every point in <span class="math inline">\([0,1]\)</span> is contained in the union <span class="math inline">\(\bigcup_{r} (V \oplus r)\)</span>.</strong> To see this, fix a point <span class="math inline">\(x\)</span> in <span class="math inline">\([0,1]\)</span>. Note that this point belongs to some equivalent class of <span class="math inline">\(x\)</span>, and in this equivalence class there exists some point <span class="math inline">\(\alpha\)</span> which belongs to <span class="math inline">\(V\)</span> as well by construction. Hence, <span class="math inline">\(\alpha \sim x\)</span>, and thus <span class="math inline">\(x-\alpha=r\in\mathbb Q\)</span>, implying that <span class="math inline">\(x\)</span> is a point in the Vitali set <span class="math inline">\(V\)</span> shifted by <span class="math inline">\(r\)</span>. Therefore, <span class="math display">\[[0,1] \subseteq  \bigcup_{r} (V \oplus r).\]</span> and we may write <span class="math display">\[1 = \operatorname{P}([0,1]) \leq \operatorname{P}\left(\bigcup_{r} (V \oplus r)\right)\leq 1,\]</span> since the measure of any set contained in another must have smaller or equal measure (a relation implied by property iii.<a href="#fn5" class="footnote-ref" id="fnref5" role="doc-noteref"><sup>5</sup></a>) as well as all probabilities are less than equal to 1<a href="#fn6" class="footnote-ref" id="fnref6" role="doc-noteref"><sup>6</sup></a>. We see that <span class="math display">\[\begin{equation}\label{eq:contr2}
\operatorname{P}\left(\bigcup_{r} (V \oplus r)\right) = 1.
\end{equation}\]</span></p></li>
</ol>
<p>Equating <span class="math inline">\(\eqref{eq:contr1}\)</span> and <span class="math inline">\(\eqref{eq:contr2}\)</span> together, we find a contradiction: A countably infinite sum of a constant value can only equal <span class="math inline">\(0\)</span>, <span class="math inline">\(+\infty\)</span> or <span class="math inline">\(-\infty\)</span>, but never 1.</p>
</div>
</section>
<section id="conditional-probability" class="level2" data-number="1.4">
<h2 data-number="1.4" class="anchored" data-anchor-id="conditional-probability"><span class="header-section-number">1.4</span> Conditional probability</h2>
<blockquote class="blockquote">
<p>The latest estimate puts the proportion of geology students at FOS to be 5%. A randomly selected student from FOS, Nafeesah, is described by her peers as someone who loves the outdoors and gets overly excited when shown something that is related to rocks.</p>
</blockquote>
<p>Which statement is more likely?</p>
<ol type="A">
<li>Nafeesah is undertaking a BSc Geology programme.</li>
<li>Nafeesah is not undertaking a BSc Geology programme.</li>
</ol>
<p>Let</p>
<ul>
<li><span class="math inline">\(E\)</span> be the ‘evidence’</li>
<li><span class="math inline">\(G\)</span> be the event that a student takes Geology</li>
</ul>
<p>Then <span class="math display">\[
\operatorname{P}(G|E) = \frac{\operatorname{P}(E|G)\operatorname{P}(G)}{\operatorname{P}(E)} \approx \frac{0.05}{\operatorname{P}(E)}
\]</span></p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="fl">1e-10</span>, <span class="dv">1</span>, <span class="at">length =</span> <span class="dv">100</span>)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>plot_df <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> x,</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">y =</span> <span class="fl">0.05</span> <span class="sc">/</span> x</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(plot_df, <span class="fu">aes</span>(x, y)) <span class="sc">+</span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="at">x =</span> <span class="sc">-</span><span class="cn">Inf</span>, <span class="at">xend =</span> <span class="fl">0.05</span> <span class="sc">/</span> <span class="fl">0.5</span>, <span class="at">y =</span> <span class="fl">0.5</span>,<span class="at">yend =</span> <span class="fl">0.5</span>,</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>               <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">col =</span> <span class="st">"red3"</span>) <span class="sc">+</span></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="at">x =</span> <span class="fl">0.05</span> <span class="sc">/</span> <span class="fl">0.5</span>, <span class="at">xend =</span> <span class="fl">0.05</span> <span class="sc">/</span> <span class="fl">0.5</span>, <span class="at">y =</span> <span class="fl">0.5</span>, <span class="at">yend =</span> <span class="sc">-</span><span class="cn">Inf</span>,</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>               <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">col =</span> <span class="st">"red3"</span>) <span class="sc">+</span></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="at">by =</span> <span class="fl">0.2</span>)) <span class="sc">+</span></span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"P(E)"</span>, <span class="at">y =</span> <span class="st">"P(G|E)"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="chapter1_files/figure-html/base_rate_fallacy-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-1"><img src="chapter1_files/figure-html/base_rate_fallacy-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
</section>
<section id="bayesian-statistics" class="level2" data-number="1.5">
<h2 data-number="1.5" class="anchored" data-anchor-id="bayesian-statistics"><span class="header-section-number">1.5</span> Bayesian statistics</h2>
<p>Sometime between 1746 and 1749, Rev.&nbsp;Thomas Bayes conducted this experiment.</p>
<blockquote class="blockquote">
<p>Imagine a square, flat table. You throw a marker (e.g.&nbsp;a coin) but do not know where it lands. You ask an assistant to randomly throw a ball on the table. The assistant informs you whether it stopped to the left or right from the first ball. How to use this information to better estimate where your marker landed?</p>
</blockquote>
<p>The Bayesian principle is about updating beliefs.</p>
<ul>
<li>Let <span class="math inline">\(X \in [0,1]\)</span> be the location of the ball on a horizontal axis.</li>
<li>Before any new information, any position <span class="math inline">\(X\)</span> is possible, say <span class="math inline">\(X\sim\mathop{\mathrm{Unif}}(0,1)\)</span>.</li>
<li>Let <span class="math inline">\(Y\)</span> be the number of times the assistant’s ball landed left of the marker after <span class="math inline">\(n\)</span> throws. Then <span class="math inline">\(Y|X \sim \mathop{\mathrm{Bin}}(n,X)\)</span>.</li>
<li>What we want is information regarding <span class="math inline">\(X|Y\)</span>, which is obtained using Bayes Theorem <span class="math display">\[
\operatorname{P}(X\in x|Y=y) = \frac{\operatorname{P}(Y=y|X\in x)\operatorname{P}(X\in x)}{\operatorname{P}(Y=y)}
\]</span></li>
</ul>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># https://dosreislab.github.io/2019/01/27/ballntable.html</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">15</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>xy <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="dv">2</span>) <span class="co"># position of coin after intial throw</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>xy<span class="fl">.2</span> <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">runif</span>(<span class="dv">2</span> <span class="sc">*</span> n), <span class="at">ncol=</span><span class="dv">2</span>) <span class="co"># additional n throws of the ball</span></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>pos <span class="ot">&lt;-</span> <span class="fu">numeric</span>(<span class="dv">2</span>)</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>pos[<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">sum</span>(xy<span class="fl">.2</span>[,<span class="dv">1</span>] <span class="sc">&lt;</span> xy[<span class="dv">1</span>])</span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>pos[<span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="fu">sum</span>(xy<span class="fl">.2</span>[,<span class="dv">2</span>] <span class="sc">&lt;</span> xy[<span class="dv">2</span>])</span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>jointf <span class="ot">&lt;-</span> <span class="cf">function</span>(<span class="at">pos =</span> pos, <span class="at">n =</span> n, <span class="at">N=</span><span class="dv">100</span>) {</span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a>  a <span class="ot">&lt;-</span> pos[<span class="dv">1</span>]; b <span class="ot">&lt;-</span> pos[<span class="dv">2</span>]</span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> y <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="at">from=</span><span class="dv">0</span>, <span class="at">to=</span><span class="dv">1</span>, <span class="at">len=</span>N)</span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a>  xf <span class="ot">&lt;-</span> x<span class="sc">^</span>a <span class="sc">*</span> (<span class="dv">1</span><span class="sc">-</span>x)<span class="sc">^</span>(n<span class="sc">-</span>a)</span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a>  yf <span class="ot">&lt;-</span> y<span class="sc">^</span>b <span class="sc">*</span> (<span class="dv">1</span><span class="sc">-</span>y)<span class="sc">^</span>(n<span class="sc">-</span>b)</span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a>  z <span class="ot">&lt;-</span> xf <span class="sc">%o%</span> yf</span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true" tabindex="-1"></a>Cf <span class="ot">&lt;-</span> <span class="cf">function</span>(x, y, n) {</span>
<span id="cb2-20"><a href="#cb2-20" aria-hidden="true" tabindex="-1"></a>  ( <span class="fu">factorial</span>(n<span class="sc">+</span><span class="dv">1</span>) )<span class="sc">^</span><span class="dv">2</span> <span class="sc">/</span></span>
<span id="cb2-21"><a href="#cb2-21" aria-hidden="true" tabindex="-1"></a>  ( <span class="fu">factorial</span>(x) <span class="sc">*</span> <span class="fu">factorial</span>(n<span class="sc">-</span>x) <span class="sc">*</span> <span class="fu">factorial</span>(y) <span class="sc">*</span> <span class="fu">factorial</span>(n<span class="sc">-</span>y) )</span>
<span id="cb2-22"><a href="#cb2-22" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb2-23"><a href="#cb2-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-24"><a href="#cb2-24" aria-hidden="true" tabindex="-1"></a>z <span class="ot">&lt;-</span> <span class="fu">jointf</span>(pos, n) <span class="sc">*</span> <span class="fu">Cf</span>(pos[<span class="dv">1</span>], pos[<span class="dv">2</span>], n)</span>
<span id="cb2-25"><a href="#cb2-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-26"><a href="#cb2-26" aria-hidden="true" tabindex="-1"></a><span class="fu">as.data.frame</span>(z) <span class="sc">%&gt;%</span></span>
<span id="cb2-27"><a href="#cb2-27" aria-hidden="true" tabindex="-1"></a>  <span class="st">`</span><span class="at">colnames&lt;-</span><span class="st">`</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">100</span> <span class="sc">/</span> <span class="dv">100</span>) <span class="sc">%&gt;%</span></span>
<span id="cb2-28"><a href="#cb2-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rownames_to_column</span>() <span class="sc">%&gt;%</span></span>
<span id="cb2-29"><a href="#cb2-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gather</span>(key, value, <span class="sc">-</span>rowname) <span class="sc">%&gt;%</span></span>
<span id="cb2-30"><a href="#cb2-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">rowname =</span> <span class="fu">as.numeric</span>(rowname) <span class="sc">/</span> <span class="dv">100</span>,</span>
<span id="cb2-31"><a href="#cb2-31" aria-hidden="true" tabindex="-1"></a>         <span class="at">key =</span> <span class="fu">as.numeric</span>(key)) <span class="sc">%&gt;%</span></span>
<span id="cb2-32"><a href="#cb2-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(rowname, key, <span class="at">z =</span> value)) <span class="sc">+</span></span>
<span id="cb2-33"><a href="#cb2-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_contour</span>() <span class="sc">+</span></span>
<span id="cb2-34"><a href="#cb2-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">x =</span> xy[<span class="dv">1</span>], <span class="at">y =</span> xy[<span class="dv">2</span>]) <span class="sc">+</span></span>
<span id="cb2-35"><a href="#cb2-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">lims</span>(<span class="at">x =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="at">y =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="chapter1_files/figure-html/bayes_ball-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-2"><img src="chapter1_files/figure-html/bayes_ball-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
</section>
<section id="probability-integral-transform" class="level2" data-number="1.6">
<h2 data-number="1.6" class="anchored" data-anchor-id="probability-integral-transform"><span class="header-section-number">1.6</span> Probability integral transform</h2>
<div id="thm-pit" class="theorem">
<p><span class="theorem-title"><strong>Theorem 1.1</strong></span> Let <span class="math inline">\(X\)</span> have continuous cdf <span class="math inline">\(F_X(x)\)</span> and define the random variable <span class="math inline">\(Y\)</span> as <span class="math inline">\(Y=F_X(X)\)</span>. Then <span class="math inline">\(Y\)</span> is uniformly distributed on <span class="math inline">\((0,1)\)</span>, that is <span class="math inline">\(f_Y(y)=1 \ \forall y\in[0,1]\)</span> with <span class="math inline">\(\operatorname{P}(Y\leq y)=y\)</span>.</p>
</div>
<div class="proof">
<p><span class="proof-title"><em>Proof</em>. </span><span class="math display">\[\begin{align*}
\operatorname{P}(Y \leq y)
&amp;= \operatorname{P}(F_X(X) \leq y) \\
&amp;= \operatorname{P}\big(X \leq F_X^{-1}(y)\big) \\
&amp;= F_X\big(F_X^{-1}(y) \big) = y.
\end{align*}\]</span></p>
</div>
<p>The PIT is a special kind of transformation, useful for various statistical purposes. Suppose we wish to generate <span class="math inline">\(X\sim F_X\)</span>–this is done via <span class="math inline">\(X=F_X^{-1}(U)\)</span> where <span class="math inline">\(U\sim\mathop{\mathrm{Unif}}(0,1)\)</span>.</p>


</section>
<section id="footnotes" class="footnotes footnotes-end-of-document" role="doc-endnotes">
<hr>
<ol>
<li id="fn1"><p><span class="math inline">\(\varnothing = \{ \}\)</span> is the empty set.<a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn2"><p>https://en.wikipedia.org/wiki/Vitali_set<a href="#fnref2" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn3"><p>Given a collection of non-empty sets, it is always possible to construct a new set by taking one element from each set in the original collection. See https://brilliant.org/wiki/axiom-of-choice/<a href="#fnref3" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn4"><p>https://www.homeschoolmath.net/teaching/rational-numbers-countable.php<a href="#fnref4" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn5"><p>Let <span class="math inline">\(A\)</span> and <span class="math inline">\(B\)</span> be such that <span class="math inline">\(A \subseteq B\)</span>. Then we may write <span class="math inline">\(B = A \cup (B\setminus A)\)</span> where the sets <span class="math inline">\(A\)</span> and <span class="math inline">\(B \setminus A\)</span> are disjoint. Hence, <span class="math inline">\(\operatorname{P}(B)=\operatorname{P}(A)+\operatorname{P}(B \setminus A)\)</span>, and since probabilities are non-negative, we have that <span class="math inline">\(\operatorname{P}(B)\geq \operatorname{P}(A)\)</span>.<a href="#fnref5" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn6"><p>For any <span class="math inline">\(A\)</span>, <span class="math inline">\(\operatorname{P}(\Omega)=\operatorname{P}(A \cup A^c) = \operatorname{P}(A) + \operatorname{P}(A^c) = 1\)</span>, so <span class="math inline">\(\operatorname{P}(A)\leq 1\)</span>.<a href="#fnref6" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./index.html" class="pagination-link" aria-label="Preface">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text">Preface</span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./chapter2.html" class="pagination-link" aria-label="Commonly used probability models">
        <span class="nav-page-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Commonly used probability models</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->
<script>var lightboxQuarto = GLightbox({"closeEffect":"zoom","descPosition":"bottom","loop":false,"openEffect":"zoom","selector":".lightbox"});
(function() {
  let previousOnload = window.onload;
  window.onload = () => {
    if (previousOnload) {
      previousOnload();
    }
    lightboxQuarto.on('slide_before_load', (data) => {
      const { slideIndex, slideNode, slideConfig, player, trigger } = data;
      const href = trigger.getAttribute('href');
      if (href !== null) {
        const imgEl = window.document.querySelector(`a[href="${href}"] img`);
        if (imgEl !== null) {
          const srcAttr = imgEl.getAttribute("src");
          if (srcAttr && srcAttr.startsWith("data:")) {
            slideConfig.href = srcAttr;
          }
        }
      } 
    });
  
    lightboxQuarto.on('slide_after_load', (data) => {
      const { slideIndex, slideNode, slideConfig, player, trigger } = data;
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(slideNode);
      }
    });
  
  };
  
})();
          </script>




</body></html>